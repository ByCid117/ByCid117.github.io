<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Interactive Keplerian Orrery</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #orrery-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #orrery {
            width: 600px;
            height: 600px;
            border: 1px solid #ccc;
            background-color: #000;
            position: relative;
        }
        .planet {
            position: absolute;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        #sun {
            width: 20px;
            height: 20px;
            background-color: #ff0;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        #controls {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        label {
            margin-bottom: 5px;
        }
        input[type="range"] {
            width: 100px;
        }
    </style>
</head>
<body>
    <div id="orrery-container">
        <div id="orrery">
            <div id="sun"></div>
        </div>
        <div id="controls">
            <div class="control-group">
                <label for="time-scale">Time Scale</label>
                <input type="range" id="time-scale" min="0" max="5" step="0.1" value="1">
            </div>
        </div>
    </div>
    <script>
        const orrery = document.getElementById('orrery');
        const timeScaleInput = document.getElementById('time-scale');
        let timeScale = 1;

        const planets = [
            { name: 'Mercury', color: '#888', a: 57.9, e: 0.206, period: 88, size: 5 },
            { name: 'Venus', color: '#ffa500', a: 108.2, e: 0.007, period: 224.7, size: 8 },
            { name: 'Earth', color: '#00f', a: 149.6, e: 0.017, period: 365.2, size: 8 },
            { name: 'Mars', color: '#f00', a: 227.9, e: 0.093, period: 687, size: 6 }
        ];

        function createPlanet(planet) {
            const planetEl = document.createElement('div');
            planetEl.className = 'planet';
            planetEl.style.backgroundColor = planet.color;
            planetEl.style.width = `${planet.size}px`;
            planetEl.style.height = `${planet.size}px`;
            orrery.appendChild(planetEl);
            return planetEl;
        }

        function updatePlanetPosition(planet, element, time) {
            const meanAnomaly = (2 * Math.PI * time) / planet.period;
            const eccentricAnomaly = solveKeplersEquation(meanAnomaly, planet.e);
            const trueAnomaly = 2 * Math.atan(Math.sqrt((1 + planet.e) / (1 - planet.e)) * Math.tan(eccentricAnomaly / 2));
            
            const r = planet.a * (1 - planet.e * planet.e) / (1 + planet.e * Math.cos(trueAnomaly));
            const scale = 250 / planets[planets.length - 1].a;
            
            const x = r * Math.cos(trueAnomaly) * scale + 300;
            const y = r * Math.sin(trueAnomaly) * scale + 300;
            
            element.style.left = `${x}px`;
            element.style.top = `${y}px`;
        }

        function solveKeplersEquation(M, e, tolerance = 1e-8, maxIterations = 100) {
            let E = M;
            for (let i = 0; i < maxIterations; i++) {
                const deltaE = (E - e * Math.sin(E) - M) / (1 - e * Math.cos(E));
                E -= deltaE;
                if (Math.abs(deltaE) < tolerance) {
                    return E;
                }
            }
            return E;
        }

        function createControls(planet, element) {
            const controlGroup = document.createElement('div');
            controlGroup.className = 'control-group';
            
            const nameLabel = document.createElement('label');
            nameLabel.textContent = planet.name;
            controlGroup.appendChild(nameLabel);

            const aInput = createSlider('a', 10, 300, planet.a, 0.1, (value) => {
                planet.a = parseFloat(value);
            });
            controlGroup.appendChild(aInput);

            const eInput = createSlider('e', 0, 0.9, planet.e, 0.001, (value) => {
                planet.e = parseFloat(value);
            });
            controlGroup.appendChild(eInput);

            const periodInput = createSlider('period', 10, 1000, planet.period, 0.1, (value) => {
                planet.period = parseFloat(value);
            });
            controlGroup.appendChild(periodInput);

            document.getElementById('controls').appendChild(controlGroup);
        }

        function createSlider(name, min, max, value, step, onChange) {
            const container = document.createElement('div');
            container.style.display = 'flex';
            container.style.alignItems = 'center';
            container.style.marginBottom = '5px';

            const label = document.createElement('label');
            label.textContent = name;
            label.style.marginRight = '5px';
            container.appendChild(label);

            const input = document.createElement('input');
            input.type = 'range';
            input.min = min;
            input.max = max;
            input.value = value;
            input.step = step;
            input.addEventListener('input', () => onChange(input.value));
            container.appendChild(input);

            const valueDisplay = document.createElement('span');
            valueDisplay.textContent = value;
            valueDisplay.style.marginLeft = '5px';
            container.appendChild(valueDisplay);

            input.addEventListener('input', () => {
                valueDisplay.textContent = parseFloat(input.value).toFixed(2);
            });

            return container;
        }

        let lastTime = 0;
        function animate(currentTime) {
            const deltaTime = (currentTime - lastTime) / 1000;
            lastTime = currentTime;

            planets.forEach((planet, index) => {
                updatePlanetPosition(planet, planetElements[index], currentTime * timeScale / 1000);
            });

            requestAnimationFrame(animate);
        }

        const planetElements = planets.map(planet => {
            const element = createPlanet(planet);
            createControls(planet, element);
            return element;
        });

        timeScaleInput.addEventListener('input', () => {
            timeScale = parseFloat(timeScaleInput.value);
        });

        requestAnimationFrame(animate);
    </script>
</body>
</html>
